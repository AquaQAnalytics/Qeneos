<rules>
    <rule name="Generic Status Rule">
        <targets>
            <target>/geneos/gateway/directory/probe/managedEntity/sampler/dataview/rows/row/cell[(@column=&quot;Status&quot;)]</target>
            <target>/geneos/gateway/directory/probe/managedEntity/sampler/dataview/rows/row/cell[(@column=&quot;status&quot;)]</target>
        </targets>
        <priority>99</priority>
        <block>
            <if>
                <like>
                    <dataItem>
                        <property>@value</property>
                    </dataItem>
                    <string>OK</string>
                </like>
                <transaction>
                    <update>
                        <property>state/@severity</property>
                        <severity>ok</severity>
                    </update>
                </transaction>
                <transaction>
                    <update>
                        <property>state/@severity</property>
                        <severity>critical</severity>
                    </update>
                </transaction>
            </if>
        </block>
    </rule>
    <rule name="Process Sampler Rule">
        <targets>
            <target>/geneos/gateway/directory/probe/managedEntity/sampler[(@name=&quot;ProcessSampler&quot;)]/dataview/rows/row/cell[(@column=&quot;status&quot;)]</target>
        </targets>
        <priority>98</priority>
        <block>
            <if>
                <like>
                    <dataItem>
                        <property>@value</property>
                    </dataItem>
                    <string>Up</string>
                </like>
                <transaction>
                    <update>
                        <property>state/@severity</property>
                        <severity>ok</severity>
                    </update>
                </transaction>
                <if>
                    <and>
                        <like>
                            <target>
                                <rowName></rowName>
                            </target>
                            <string>killtick</string>
                        </like>
                        <like>
                            <dataItem>
                                <property>@value</property>
                            </dataItem>
                            <string>Down</string>
                        </like>
                    </and>
                    <transaction>
                        <update>
                            <property>state/@severity</property>
                            <severity>undefined</severity>
                        </update>
                    </transaction>
                    <if>
                        <and>
                            <like>
                                <target>
                                    <rowName></rowName>
                                </target>
                                <string>tpreplay1</string>
                            </like>
                            <like>
                                <dataItem>
                                    <property>@value</property>
                                </dataItem>
                                <string>Down</string>
                            </like>
                        </and>
                        <transaction>
                            <update>
                                <property>state/@severity</property>
                                <severity>undefined</severity>
                            </update>
                        </transaction>
                        <transaction>
                            <update>
                                <property>state/@severity</property>
                                <severity>critical</severity>
                            </update>
                        </transaction>
                    </if>
                </if>
            </if>
        </block>
    </rule>
    <rule name="Process Check">
        <targets>
            <target>/geneos/gateway/directory/probe/managedEntity/sampler[wild(@name,&quot;*Process Check&quot;)]/dataview/rows/row/cell[(@column=&quot;instanceCount&quot;)]</target>
        </targets>
        <priority>1</priority>
        <block>
            <if>
                <like>
                    <target>
                        <rowName></rowName>
                    </target>
                    <string>*#*</string>
                </like>
                <transaction>
                    <update>
                        <property>state/@severity</property>
                        <severity>undefined</severity>
                    </update>
                </transaction>
                <if>
                    <equal>
                        <dataItem>
                            <property>@value</property>
                        </dataItem>
                        <integer>0</integer>
                    </equal>
                    <transaction>
                        <update>
                            <property>state/@severity</property>
                            <severity>critical</severity>
                        </update>
                    </transaction>
                    <transaction>
                        <update>
                            <property>state/@severity</property>
                            <severity>ok</severity>
                        </update>
                    </transaction>
                </if>
            </if>
        </block>
    </rule>
</rules>
